import{d as B,g as v,f as l,o as p,h as N,i as z,j as O,w as o,a as y,b as e,e as h,c as D,k as q,u as w,F as U,r as E,l as G,s as I,t as H}from"./index-3ec4d8b2.js";const J=B({__name:"PaginationItem",props:{total:null,pageSize:null},emits:["sizeChange","currentChange"],setup(b,{emit:m}){const r=c=>{m("sizeChange",c)},_=c=>{m("currentChange",c)};return(c,t)=>{const s=l("el-pagination");return p(),v(s,{layout:"sizes, prev, pager, next","page-sizes":[10,20,30],"pager-count":5,"page-size":b.pageSize,total:b.total,onSizeChange:r,onCurrentChange:_,class:"justify-end my-3"},null,8,["page-size","total"])}}}),K={class:"dialog-footer"},Q=B({__name:"EditDialog",props:{visable:Boolean,data:{type:Object,required:!0}},emits:["close","update"],setup(b,{emit:m}){const r=b,c=N().memberTypeMap,t=z({uid:0,account:"",memberType:"",createTime:""});O(()=>r.visable,()=>{r.visable&&(t.uid=r.data.uid,t.account=r.data.account,t.memberType=r.data.memberType,t.createTime=r.data.createTime)});const s=()=>{m("close")},C=()=>{m("update",t)};return($,g)=>{const V=l("el-input"),T=l("el-form-item"),M=l("el-option"),f=l("el-select"),n=l("el-form"),a=l("el-button"),i=l("el-dialog");return p(),v(i,{"model-value":b.visable,title:"編輯",width:"80%","before-close":s},{footer:o(()=>[y("span",K,[e(a,{onClick:s},{default:o(()=>[h("取消")]),_:1}),e(a,{type:"primary",onClick:C},{default:o(()=>[h(" 儲存 ")]),_:1})])]),default:o(()=>[e(n,{model:t},{default:o(()=>[e(T,{label:"名稱："},{default:o(()=>[e(V,{modelValue:t.account,"onUpdate:modelValue":g[0]||(g[0]=u=>t.account=u),clearable:"",placeholder:"名稱"},null,8,["modelValue"])]),_:1}),e(T,{label:"身分："},{default:o(()=>[e(f,{modelValue:t.memberType,"onUpdate:modelValue":g[1]||(g[1]=u=>t.memberType=u),placeholder:"請選擇會員類型"},{default:o(()=>[(p(!0),D(U,null,q(w(c),([u,x])=>(p(),v(M,{key:x,value:u,label:x},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["model-value"])}}}),R={class:"flex-col"},W={class:"text-2xl font-extrabold text-gray-600 flex items-center"},X={class:"my-1 h-full flex flex-col"},Y={class:"flex flex-row items-center my-3"},ee=B({__name:"MemberManagement",setup(b){const m=N(),r=m.memberTypeMap,_=E(!1),c=z({uid:0,account:"",memberType:"",createTime:""}),t=z({total:0,pageSize:10,currentPage:1}),s=z({account:"",memberType:""}),C=E([]),$=n=>{const a=m.getMemberData(n);if(a===void 0){I("有哪裡壞了","warning");return}c.uid=a.uid,c.account=a.account,c.memberType=a.memberType,c.createTime=a.createTime,_.value=!0},g=()=>{_.value=!1},V=n=>{m.updateMember(n.uid,n),I("更新成功","success"),_.value=!1},T=n=>{t.pageSize=n,f()},M=n=>{t.currentPage=n,f()},f=()=>{const n=(t.currentPage-1)*t.pageSize,a=n+t.pageSize;let i=m.getAllMemberData();s.account&&(i=i.filter(u=>u.account.includes(s.account))),s.memberType&&(i=i.filter(u=>u.memberType===s.memberType)),t.total=i.length,C.value=i.slice(n,a)};return G(()=>{f()}),(n,a)=>{const i=l("UserFilled"),u=l("el-icon"),x=l("el-input"),F=l("el-form-item"),P=l("el-option"),A=l("el-select"),j=l("el-button"),S=l("el-table-column"),L=l("el-table");return p(),D(U,null,[e(Q,{visable:_.value,data:c,onClose:g,onUpdate:V},null,8,["visable","data"]),y("div",R,[y("div",W,[e(u,{class:"mr-2"},{default:o(()=>[e(i)]),_:1}),h(" 成員管理區 ")]),y("div",X,[y("div",Y,[e(F,{label:"學生姓名："},{default:o(()=>[e(x,{modelValue:s.account,"onUpdate:modelValue":a[0]||(a[0]=d=>s.account=d),clearable:"",placeholder:"名稱"},null,8,["modelValue"])]),_:1}),e(F,{label:"身分：",class:"ml-3"},{default:o(()=>[e(A,{modelValue:s.memberType,"onUpdate:modelValue":a[1]||(a[1]=d=>s.memberType=d),placeholder:"請選擇會員類型"},{default:o(()=>[(p(),v(P,{key:"",value:"",label:"全選"})),(p(!0),D(U,null,q(w(r),([d,k])=>(p(),v(P,{key:k,value:d,label:k},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(j,{class:"mb-[18px] ml-3",onClick:a[2]||(a[2]=d=>f()),type:"success"},{default:o(()=>[h(" 搜尋 ")]),_:1})]),y("div",null,[e(L,{data:C.value,border:"",height:"530",style:{width:"100%"},"scrollbar-always-on":!0},{default:o(()=>[e(S,{prop:"account",label:"名稱"}),e(S,{prop:"memberType",label:"會員身分",sortable:!0},{default:o(({row:d})=>[h(H(w(r).get(d.memberType)),1)]),_:1}),e(S,{prop:"createTime",label:"創建時間",sortable:!0}),e(S,{label:"管理"},{default:o(({row:d})=>[e(j,{type:"info",onClick:k=>$(d.uid)},{default:o(()=>[h(" 編輯 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(J,{total:t.total,pageSize:t.pageSize,onSizeChange:T,onCurrentChange:M},null,8,["total","pageSize"])])])])],64)}}});export{ee as default};
